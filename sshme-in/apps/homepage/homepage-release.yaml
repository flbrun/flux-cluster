apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: homepage
spec:
  interval: 5m
  chart:
    spec:
      chart: homepage
      sourceRef:
        kind: HelmRepository
        name: truecharts
        namespace: flux-system
  values:
    workload:
      main:
        podSpec:
          containers:
            main:
              env:
                HOMEPAGE_ALLOWED_HOSTS: "home.sshme.in"
    persistence:
      config:
        enabled: true
    configmap:
      config:
        enabled: true
        data:
          custom.js: ""
          custom.css: ""
          kubernetes.yaml: |
            mode: cluster
            gateway: true
          settings.yaml: |
            ---
            # For configuration options and examples, please see:
            # https://gethomepage.dev/latest/configs/settings
            background: https://images.unsplash.com/photo-1448375240586-882707db888b?q=80&w=1740&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D

            providers:
              openweathermap: openweathermapapikey
              weatherapi: weatherapiapikey
          widgets.yaml: |
            ---
            # For configuration options and examples, please see:
            # https://gethomepage.dev/latest/configs/widgets

            - search:
                provider: custom
                url: https://www.ecosia.org/search?q=
                target: _blank
                suggestionUrl: https://ac.ecosia.org/autocomplete?type=list&q=
                showSearchSuggestions: true


          services.yaml: |
            ---
            # For configuration options and examples, please see:
            # https://gethomepage.dev/latest/configs/services

          #  - Arr:
          #      - My First Service:
          #          href: http://localhost/
          #          description: Homepage is awesome

          #  - Media:
          #      - My Second Service:
          #          href: http://localhost/
          #          description: Homepage is the best

          #  - Infra:
          #      - My Third Service:
          #          href: http://localhost/
          #          description: Homepage is ðŸ˜Ž
          bookmarks.yaml: |
            ---
            # For configuration options and examples, please see:
            # https://gethomepage.dev/latest/configs/bookmarks

            - Developer:
                - Github:
                    - abbr: GH
                      href: https://github.com/

          #  - Social:
          #      - Reddit:
          #          - abbr: RE
          #            href: https://reddit.com/

          #  - Entertainment:
          #      - YouTube:
          #          - abbr: YT
          #            href: https://youtube.com/
    forceConfigFromValues: false
    rbac:
      main:
        rules:
          - apiGroups:
              - gateway.networking.k8s.io
            resources:
              - httproutes
            verbs:
              - get
              - list
          - apiGroups: [""]
            resources:
              - namespaces
              - pods
              - nodes
            verbs:
              - get
              - list
          - apiGroups:
              - extensions
              - networking.k8s.io
            resources:
              - ingresses
            verbs:
              - get
              - list
          - apiGroups:
              - metrics.k8s.io
            resources:
              - nodes
              - pods
            verbs:
              - get
              - list
          - apiGroups:
              - apiextensions.k8s.io
            resources:
              - customresourcedefinitions/status
            verbs:
              - get